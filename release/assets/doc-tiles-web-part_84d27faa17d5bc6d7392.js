define("72b368fb-f784-4b6c-81ad-49ba9b768e08_0.0.1",["react","react-dom","@microsoft/sp-webpart-base","@microsoft/sp-property-pane"],(e,t,n,a)=>(()=>{"use strict";var i={946:(e,t,n)=>{n.r(t);var a,i,r,o=function(){return o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},o.apply(this,arguments)},s="undefined"==typeof window?n.g:window,c=s&&s.CSPSettings&&s.CSPSettings.nonce,d=((r=s.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(r=o(o({},r),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:0,buffer:[]}})),r.registeredThemableStyles||(r=o(o({},r),{registeredThemableStyles:[]})),s.__themeState__=r,r),l=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,u=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function f(e){var t=u();e();var n=u();d.perf.duration+=n-t}function p(e,t){d.loadStyles?d.loadStyles(m(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=m(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),c&&n.setAttribute("nonce",c),n.appendChild(document.createTextNode(i)),d.perf.count++,t.appendChild(n);var o=document.createEvent("HTMLEvents");o.initEvent("styleinsert",!0,!1),o.args={newStyle:n},document.dispatchEvent(o);var s={styleElement:n,themableStyle:e};r?d.registeredThemableStyles.push(s):d.registeredStyles.push(s)}}(e)}function m(e){var t=d.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}a=".host_51f82e1a{--deep-blue:#114461;--lightblue:#00aeef;--orange:#fb8c2e;--muted:#6a7a86;--ink:#0f2430;--shadow:0 6px 22px rgba(17,68,97,.12);--inner:0 1px 0 rgba(17,68,97,.06),0 10px 24px rgba(17,68,97,.08);--fs-12:12px;--fs-13:13px;--fs-14:14px;--fs-15:15px;--fs-16:16px;--fs-18:18px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:var(--ink);font-family:Segoe UI Variable,Segoe UI,system-ui,-apple-system,BlinkMacSystemFont,Roboto,Helvetica,Arial,sans-serif;font-size:var(--fs-14);line-height:1.5;text-rendering:optimizeLegibility}.header_51f82e1a{align-items:center;display:flex;gap:12px;margin-bottom:10px}.header_51f82e1a h2{color:var(--deep-blue);font-family:Segoe UI Variable Display,Segoe UI,system-ui,sans-serif;font-size:20px;font-weight:600;letter-spacing:.3px;line-height:1.4;margin:0}.header_51f82e1a a{color:var(--lightblue);font-size:var(--fs-14);font-weight:700;margin-left:auto;text-decoration:none}.header_51f82e1a a:hover{text-decoration:underline}.status_51f82e1a{color:var(--muted);margin-bottom:12px}.grid_51f82e1a{display:grid;gap:18px;grid-template-columns:repeat(auto-fit,minmax(340px,1fr))}@media (max-width:480px){.grid_51f82e1a{grid-template-columns:1fr}}.card_51f82e1a{background:#fff;border-radius:20px;box-shadow:var(--shadow);display:flex;flex-direction:column;padding:0 16px 12px}.catbar_51f82e1a{align-items:center;background:var(--deep-blue);border-radius:14px;color:#fff;display:flex;font-family:Segoe UI Variable Display,Segoe UI,system-ui,sans-serif;gap:10px;margin:16px 0 14px;padding:8px 14px}.catname_51f82e1a{font-size:14px;font-weight:700;letter-spacing:.8px}.count_51f82e1a{font-size:13px;font-weight:600;margin-left:auto;opacity:.95}.doclist_51f82e1a{display:grid;gap:12px;grid-template-columns:1fr}.pill_51f82e1a{align-items:center;background:#fff;border:1px solid rgba(17,68,97,.16);border-radius:999px;box-shadow:var(--inner);color:var(--ink);display:flex;gap:12px;padding:12px 16px;text-decoration:none;transition:transform 60ms ease,box-shadow .12s ease,border-color .12s ease,background .12s ease}.title_51f82e1a{flex:1 1 auto;font-size:var(--fs-15);font-weight:600;letter-spacing:.1px}.clamp2_51f82e1a .title_51f82e1a{line-clamp:2;-webkit-line-clamp:2;-webkit-box-orient:vertical;display:-webkit-box;line-height:1.35em;max-height:2.7em;overflow:hidden;text-overflow:ellipsis}.dot_51f82e1a{background:var(--orange);border-radius:50%;flex:0 0 auto;height:12px;width:12px}.pill_51f82e1a:hover{background:#f7fbff;border-color:var(--lightblue);box-shadow:0 10px 26px rgba(17,68,97,.14);transform:translateY(-1px)}.pill_51f82e1a:focus{box-shadow:0 0 0 4px rgba(0,174,239,.45);outline:3px solid #fff;outline-offset:2px}.foot_51f82e1a{display:flex;justify-content:flex-end;margin-top:12px}.more_51f82e1a{color:var(--lightblue);font-size:var(--fs-14);font-weight:700;text-decoration:none}.more_51f82e1a:hover{text-decoration:underline}",void 0===(i=!0)&&(i=!1),f(function(){var e=Array.isArray(a)?a:function(e){var t=[];if(e){for(var n=0,a=void 0;a=l.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=l.lastIndex}t.push({rawString:e.substring(n)})}return t}(a),t=d.runState,n=t.mode,r=t.buffer,o=t.flushTimer;i||1===n?(r.push(e),o||(d.runState.flushTimer=setTimeout(function(){d.runState.flushTimer=0,f(function(){var e=d.runState.buffer.slice();d.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&p(t)})},0))):p(e)})}
,723:e=>{e.exports=a},134:e=>{e.exports=n},650:t=>{t.exports=e},729:e=>{e.exports=t}},r={};function o(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return i[e](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{o.r(s),o.d(s,{default:()=>yt});var e=o(650),t=o(729),n=o(134),a=o(723);function i(e,t,n){let a=new Date(e.toString());switch(t.toLowerCase()){case"year":a.setFullYear(a.getFullYear()+n);break;case"quarter":a.setMonth(a.getMonth()+3*n);break;case"month":a.setMonth(a.getMonth()+n);break;case"week":a.setDate(a.getDate()+7*n);break;case"day":a.setDate(a.getDate()+n);break;case"hour":a.setTime(a.getTime()+36e5*n);break;case"minute":a.setTime(a.getTime()+6e4*n);break;case"second":a.setTime(a.getTime()+1e3*n);break;default:a=void 0}return a}function r(...e){return e.filter(e=>!f(e)).map(e=>e.replace(/^[\\|/]/,"").replace(/[\\|/]$/,"")).join("/").replace(/\\/g,"/")}function c(){let e=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function d(e){return"function"==typeof e}function l(e){return Array.isArray(e)}function u(e){return/^https?:\/\/|^\/\//i.test(e)}function f(e){return null==e||e.length<1}function p(e){return null!=e}function m(e){return JSON.stringify(e)}function _(e,t){return Object.hasOwnProperty.call(e,t)}let h;function b(){return void 0===h&&(h=new v),h}class g{constructor(e){this.store=e,this.enabled=this.test()}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!p(t))return null;const n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value}put(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))}delete(e){this.enabled&&this.store.removeItem(e)}async getOrPut(e,t,n){if(!this.enabled)return t();let a=this.get(e);return null===a&&(a=await t(),this.put(e,a,n)),a}async deleteExpired(){if(this.enabled)for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&await this.get(t)}}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){return void 0===t&&(t=i(new Date,"minute",5)),m({pnp:1,expiration:t,value:e})}}class v{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}function y(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t)}}function S(){return async function(e,...t){return[...e].reduce((e,t)=>e.then(e=>Reflect.apply(t,this,e)),Promise.resolve(t))}}function D(){return function(e,...t){const n=[...e];for(let e=0;e<n.length;e++)Reflect.apply(n[e],this,t);return this}}const I=Symbol.for("ObserverLifecycleFlags"),x=e=>t=>!((t[I]||0)&e),C=e=>t=>(t[I]=(t[I]||0)|e,t);C(1),C(2);class O{constructor(e,t={}){this.moments=e,this.observers=t,this._onProxy=null,this._emitProxy=null,this._inheritingObservers=!0}using(...e){for(let t=0;t<e.length;t++)e[t](this);return this}get on(){return null===this._onProxy&&(this._onProxy=new Proxy(this,{get:(e,t)=>Object.assign(n=>(e.cloneObserversOnChange(),w(e.observers,t,n,1),e),{toArray:()=>Reflect.has(e.observers,t)?[...Reflect.get(e.observers,t)]:[],replace:n=>(e.cloneObserversOnChange(),w(e.observers,t,n,3),e),prepend:n=>(e.cloneObserversOnChange(),w(e.observers,t,n,2),e),clear:()=>!!Reflect.has(e.observers,t)&&(e.cloneObserversOnChange(),e.observers[t].length=0,!0)})})),this._onProxy}log(e,t=0){this.emit.log(e,t)}error(e){p(e)&&this.emit.error(e)}get emit(){return null===this._emitProxy&&(this._emitProxy=new Proxy(this,{get:(e,t)=>(...n)=>{const a=Reflect.has(e.observers,t)?Reflect.get(e.observers,t):[];if((!l(a)||a.length<1)&&"error"===t)throw Error(`Unhandled Exception: ${n[0]}`);try{const i=Reflect.has(e.moments,t)?Reflect.get(e.moments,t):"init"===t||"dispose"===t?D():y();return Reflect.apply(i,e,[a,...n])}catch(e){if("error"===t)throw e;this.error(e)}finally{a&&a.length>0&&Reflect.set(e.observers,t,a.filter(x(2)))}}})),this._emitProxy}start(e){this.emit.init();const t=this.execute(e);return t.finally(()=>{try{this.emit.dispose()}catch(e){const t=Object.assign(Error("Error in dispose."),{innerException:e});this.error(t)}}).catch(()=>{}),t}cloneObserversOnChange(){this._inheritingObservers&&(this._inheritingObservers=!1,this.observers=E(this.observers))}}function w(e,t,n,a){if(!d(n))throw Error("Observers must be functions.");if(Reflect.has(e,t))switch(a){case 1:e[t].push(n);break;case 2:e[t].unshift(n);break;case 3:e[t].length=0,e[t].push(n)}else e[t]=[n];return e[t]}function E(e){return Reflect.ownKeys(e).reduce((t,n)=>(t[n]=[...e[n].filter(x(1))],t),{})}function A(e,t="append",n){return a=>Reflect.apply(L,a,[e,t,n])}function L(e,t,n){if(!p(e)||!p(e.observers))return this;d(n)||(n=()=>!0);const a=E(e.observers),i=Object.keys(a).filter(n);for(let e=0;e<i.length;e++){const n=i[e],r=this.on[n];"replace"===t&&r.clear(),a[n].forEach(e=>r(e))}return this}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const k={construct:D(),pre:S(),auth:S(),send:async function(e,...t){if(!l(e)||e.length<1)return;const n=e[0];return Reflect.apply(n,this,t)},parse:S(),post:S(),data:y()};let M=class extends O{constructor(e,t){let n;if(super(k),this.InternalResolve=Symbol.for("Queryable_Resolve"),this.InternalReject=Symbol.for("Queryable_Reject"),this.InternalPromise=Symbol.for("Queryable_Promise"),this._query=new URLSearchParams,this.moments[this.InternalPromise]=function(e,...t){return[...e].reduce((e,t)=>Reflect.apply(t,this,e),t)},"string"==typeof e)this._url=r(e,t);else if(l(e)){if(2!==e.length)throw Error("When using the tuple param exactly two arguments are expected.");if("string"!=typeof e[1])throw Error("Expected second tuple param to be a string.");n=e[0],this._url=r(e[1],t)}else n=e,this._url=r(n._url,t);void 0!==n&&(this.observers=n.observers,this._inheritingObservers=!0)}concat(e){return this._url+=e,this}toRequestUrl(){let e=this.toUrl();const t=this.query.toString();return f(t)||(e+=`${e.indexOf("?")>-1?"&":"?"}${t}`),e}get query(){return this._query}toUrl(){return this._url}execute(e){if(Reflect.ownKeys(this.observers).length<1)throw Error("No observers registered for this request. (https://pnp.github.io/pnpjs/queryable/queryable#no-observers-registered-for-this-request)");return setTimeout(async()=>{const t=c();let n;const a=(e,n)=>{this.log(`[${t}] ${e}`,n)};try{a("Beginning request",0);const i={...e,headers:{...e.headers,"X-PnPjs-RequestId":t}};let[r,o,s]=await this.emit.pre(this.toRequestUrl(),i,void 0);if(a(`Url: ${r}`,1),void 0!==s)return a("Result returned from pre, Emitting data"),this.emit.data(s),void a("Emitted data");a("Emitting auth"),[n,o]=await this.emit.auth(new URL(r),o),a("Emitted auth"),o={...o,...e,headers:{...o.headers,...e.headers}},a("Emitting send");let c=await this.emit.send(n,o);a("Emitted send"),a("Emitting parse"),[n,c,s]=await this.emit.parse(n,c,s),a("Emitted parse"),a("Emitting post"),[n,s]=await this.emit.post(n,s),a("Emitted post"),a("Emitting data"),this.emit.data(s),a("Emitted data")}catch(e){a(`Emitting error: "${e.message||e}"`,3),this.error(e),a("Emitted error",3)}finally{a("Finished request",0)}},0),this.emit[this.InternalPromise](new Promise((e,t)=>{this.on[this.InternalResolve].replace(e),this.on[this.InternalReject].replace(t)}))[0]}};var P;function T(e,t={headers:{}}){return{method:e,...t,headers:{...t.headers}}}function U(e){return this.start(T("GET",e))}function F(e){return this.start(T("POST",e))}function H(e,t,n){return Reflect.apply(t,e,[n])}async function R(e,t,n){if(!t.ok)throw await j.init(t);return[e,t,n]}function N(e){let t=e;return _(e,"d")?t=_(e.d,"results")?e.d.results:e.d:_(e,"value")&&(t=e.value),t}function B(e){return t=>(t.on.parse.replace(R),t.on.parse(async(t,n,a)=>(n.ok&&void 0===a&&(a=await e(n)),[t,n,a])),t)}M=function(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}([e=>new Proxy(e,{construct(e,t,n){const a=Object.assign(function(e){return d(P)||(P=function(e){return H(this,U,e)}),Reflect.apply(P,a,[e])},Reflect.construct(e,t,n));return Reflect.setPrototypeOf(a,n.prototype),a}})],M);class j extends Error{constructor(e,t,n=t.status,a=t.statusText){super(e),this.response=t,this.status=n,this.statusText=a,this.isHttpRequestError=!0}static async init(e){const t=await e.clone().text();return new j(`Error making HttpClient request in queryable [${e.status}] ${e.statusText} ::> ${t}`,e)}}function V(e,t,n,a){Reflect.defineProperty(e.prototype,t,{configurable:!0,enumerable:!0,get:function(){return n(this,a||t)}})}function z(e,t){return Object.assign({body:m(e)},t)}function G(e,t){return Object.assign({},t,{headers:{...null==t?void 0:t.headers,...e}})}new class{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=new g("undefined"==typeof localStorage?b():localStorage)),this._local}get session(){return null===this._session&&(this._session=new g("undefined"==typeof sessionStorage?b():sessionStorage)),this._session}},Symbol.for("CancelScopeId"),new Map;const K=e=>{return t=e,(e,n)=>{const a=new t(e,n);return a.emit.construct(e,n),a};var t};class W extends M{constructor(e,t){if("string"==typeof e){let n="",a="";if(u(e)||e.lastIndexOf("/")<0)a=e,n=r(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const i=e.lastIndexOf("/");a=e.slice(0,i),t=r(e.slice(i),t),n=r(a,t)}else{const i=e.lastIndexOf("(");a=e.slice(0,i),n=r(e,t)}super(n),this.parentUrl=a}else{super(e,t);const n=l(e)?e[0]:e;this.parentUrl=l(e)?e[1]:n.toUrl()}}toRequestUrl(){const e=new URLSearchParams(this.query);let t=this.toUrl().replace(/'!(@.+?)::((?:[^']|'')+)'/gi,(t,n,a)=>(this.log(`Rewriting aliased parameter from match ${t} to label: ${n} value: ${a}`,0),e.set(n,`'${a}'`),n));const n=e.toString();return f(n)||(t+=`${t.indexOf("?")>-1?"&":"?"}${n}`),t}select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}getParent(e,t,n=this.parentUrl){return e([this,n],t)}}const q=K(W);class Q extends W{filter(e){return"object"==typeof e?(this.query.set("$filter",e.toString()),this):"function"==typeof e?(this.query.set("$filter",e(de.Where()).toString()),this):(this.query.set("$filter",e.toString()),this)}orderBy(e,t=!0){const n="$orderby",a=this.query.has(n)?this.query.get(n).split(","):[];return a.push(`${e} ${t?"asc":"desc"}`),this.query.set(n,a.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}const Y=K(Q);class J extends W{}const X=K(J);function Z(){return function(){return ne(this)}}function $(){return function(e="*"){return ae(this,{},e)}}const ee=(e,t)=>H(e,F,t),te=(e,t)=>((t=t||{}).headers={...t.headers,"X-HTTP-Method":"MERGE"},ee(e,t)),ne=(e,t)=>((t=t||{}).headers={...t.headers||{},"X-HTTP-Method":"DELETE"},ee(e,t)),ae=(e,t,n="*")=>((t=t||{}).headers={...t.headers||{},"IF-Match":n},ne(e,t));var ie,re,oe,se,ce;!function(e){e.Equals="eq",e.NotEquals="ne",e.GreaterThan="gt",e.GreaterThanOrEqualTo="ge",e.LessThan="lt",e.LessThanOrEqualTo="le",e.StartsWith="startswith",e.SubstringOf="substringof"}(ie||(ie={})),function(e){e.And="and",e.AndWithSpace=" and ",e.Or="or",e.OrWithSpace=" or "}(re||(re={}));class de{static Where(){return new me([])}}class le{constructor(e){this.query=[],this.query=e}}class ue extends le{constructor(e){super(e)}text(e){return new ge([...this.query,e])}choice(e){return new ge([...this.query,e])}multiChoice(e){return new ge([...this.query,e])}number(e){return new Se([...this.query,e])}date(e){return new De([...this.query,e])}boolean(e){return new ve([...this.query,e])}lookup(e){return new _e([...this.query],e)}lookupId(e){const t=e.endsWith("Id")?e:`${e}Id`;return new Se([...this.query,t])}}class fe extends ue{or(...e){return new Ie([...this.query,`(${e.map(e=>e.toString()).join(re.OrWithSpace)})`])}}class pe extends ue{and(...e){return new Ie([...this.query,`(${e.map(e=>e.toString()).join(re.AndWithSpace)})`])}}class me extends ue{or(...e){return null==e||0===e.length?new ue([...this.query,re.Or]):new Ie([...this.query,`(${e.map(e=>e.toString()).join(re.OrWithSpace)})`])}and(...e){return null==e||0===e.length?new ue([...this.query,re.And]):new Ie([...this.query,`(${e.map(e=>e.toString()).join(re.AndWithSpace)})`])}}class _e extends le{constructor(e,t){super(e),this.LookupField=t}Id(e){return new Ie([...this.query,`${this.LookupField}/Id`,ie.Equals,e.toString()])}text(e){return new ge([...this.query,`${this.LookupField}/${e}`])}number(e){return new Se([...this.query,`${this.LookupField}/${e}`])}}class he extends le{constructor(e){super(e),this.LastIndex=e.length-1,this.InternalName=e[this.LastIndex]}toODataValue(e){return`'${e}'`}isNull(){return new Ie([...this.query,ie.Equals,"null"])}isNotNull(){return new Ie([...this.query,ie.NotEquals,"null"])}}class be extends he{equals(e){return new Ie([...this.query,ie.Equals,this.toODataValue(e)])}notEquals(e){return new Ie([...this.query,ie.NotEquals,this.toODataValue(e)])}in(...e){return de.Where().or(...e.map(e=>this.equals(e)))}notIn(...e){return de.Where().and(...e.map(e=>this.notEquals(e)))}}class ge extends be{startsWith(e){const t=`${ie.StartsWith}(${this.InternalName}, ${this.toODataValue(e)})`;return this.query[this.LastIndex]=t,new Ie([...this.query])}contains(e){const t=`${ie.SubstringOf}(${this.toODataValue(e)}, ${this.InternalName})`;return this.query[this.LastIndex]=t,new Ie([...this.query])}}class ve extends he{toODataValue(e){return`${null==e?"null":e?1:0}`}isTrue(){return new Ie([...this.query,ie.Equals,this.toODataValue(!0)])}isFalse(){return new Ie([...this.query,ie.Equals,this.toODataValue(!1)])}isFalseOrNull(){const e=`(${[this.InternalName,ie.Equals,this.toODataValue(null),re.Or,this.InternalName,ie.Equals,this.toODataValue(!1)].join(" ")})`;return this.query[this.LastIndex]=e,new Ie([...this.query])}}class ye extends be{greaterThan(e){return new Ie([...this.query,ie.GreaterThan,this.toODataValue(e)])}greaterThanOrEquals(e){return new Ie([...this.query,ie.GreaterThanOrEqualTo,this.toODataValue(e)])}lessThan(e){return new Ie([...this.query,ie.LessThan,this.toODataValue(e)])}lessThanOrEquals(e){return new Ie([...this.query,ie.LessThanOrEqualTo,this.toODataValue(e)])}}class Se extends ye{toODataValue(e){return`${e}`}}class De extends ye{toODataValue(e){return`'${e.toISOString()}'`}isBetween(e,t){const n=`(${[this.InternalName,ie.GreaterThan,this.toODataValue(e),re.And,this.InternalName,ie.LessThan,this.toODataValue(t)].join(" ")})`;return this.query[this.LastIndex]=n,new Ie([...this.query])}isToday(){const e=new Date;e.setHours(0,0,0,0);const t=new Date;return t.setHours(23,59,59,999),this.isBetween(e,t)}}class Ie extends le{and(...e){return null==e||0===e.length?new fe([...this.query,re.And]):new Ie([...this.query,re.And,`(${e.map(e=>e.toString()).join(re.AndWithSpace)})`])}or(...e){return null==e||0===e.length?new pe([...this.query,re.Or]):new Ie([...this.query,re.Or,`(${e.map(e=>e.toString()).join(re.OrWithSpace)})`])}toString(){return this.query.join(" ")}}class xe{constructor(e=""){this._root=q(e)}using(...e){return this._root.using(...e),this}create(e,t){return e(this._root,t)}}function Ce(e=""){return"object"!=typeof e||Reflect.has(e,"length")||(e=e._root),new xe(e)}function Oe(e){if(f(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substring(0,t):e}function we(e){const t=[],n=["odata.type","odata.editLink","__metadata","odata.metadata","odata.id"];if(_(e,n[0])&&"SP.Web"===e[n[0]])_(e,n[4])?t.push(e[n[4]]):_(e,n[2])&&t.push(e.__metadata.uri);else if(_(e,n[3])&&_(e,n[1])){const a=u(e[n[1]])?e[n[1]].split("_api")[1]:e[n[1]];t.push(Oe(e[n[3]]),"_api",a)}else _(e,n[1])?t.push("_api",e[n[1]]):_(e,n[2])&&t.push(e.__metadata.uri);return t.length<1?"":r(...t)}function Ee(e){return f(e)?"":/!(@.*?)::(.*?)/gi.test(e)?e.replace(/!(@.*?)::(.*)$/gi,(e,t,n)=>`!${t}::${n.replace(/'/gi,"''")}`):encodeURIComponent(e.replace(/'/gi,"''"))}function Ae(e,t,n,a){var i,r=arguments.length,o=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,n):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,a);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(r<3?i(o):r>3?i(t,n,o):i(t,n))||o);return r>3&&o&&Object.defineProperty(t,n,o),o}function Le(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}!function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(oe||(oe={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(se||(se={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(ce||(ce={})),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;let ke=class extends Q{async add(e,t,n="",a="STS",i=1033,r=!0){const o=z({parameters:{Description:n,Language:i,Title:e,Url:t,UseSamePermissionsAsParentSite:r,WebTemplate:a}});return ee(Me(this,"add"),o)}};ke=Ae([Le("webs")],ke);const Me=K(ke);function Pe(e,t){let n="_api/web";const a=/(_api[/|\\](site\/rootweb|site|web))/i.exec(e);return(null==a?void 0:a.length)>0&&(e=Oe(e),n=a[1]),(null==t?void 0:t.indexOf("_api"))<0&&(e=r(e,n)),e}let Te=class extends J{constructor(e,t){super(e="string"==typeof e?Pe(e,t):l(e)?[e[0],Pe(e[1],t)]:[e,Pe(e.toUrl(),t)],t),this.delete=Z()}get webs(){return Me(this)}get allProperties(){return X(this,"allproperties")}get webinfos(){return Y(this,"webinfos")}async getParentWeb(){const{Url:e,ParentWeb:t}=await this.select("Url","ParentWeb/ServerRelativeUrl").expand("ParentWeb")();return(null==t?void 0:t.ServerRelativeUrl)?Ue([this,r(new URL(e).origin,t.ServerRelativeUrl)]):null}async update(e){return te(this,z(e))}applyTheme(e,t,n,a){const i=z({backgroundImageUrl:n,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:a});return ee(Ue(this,"applytheme"),i)}applyWebTemplate(e){return ee(Ue(this,`applywebtemplate(webTemplate='${Ee(e)}')`))}getChanges(e){return ee(Ue(this,"getchanges"),z({query:e}))}mapToIcon(e,t=0,n=""){return Ue(this,`maptoicon(filename='${Ee(e)}',progid='${Ee(n)}',size=${t})`)()}getStorageEntity(e){return Ue(this,`getStorageEntity('${Ee(e)}')`)()}setStorageEntity(e,t,n="",a=""){return ee(Ue(this,"setStorageEntity"),z({comments:a,description:n,key:e,value:t}))}removeStorageEntity(e){return ee(Ue(this,`removeStorageEntity('${Ee(e)}')`))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){return Y(this,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`)}availableWebTemplates(e=1033,t=!0){return Y(this,`getavailablewebtemplates(lcid=${e},doincludecrosslanguage=${t})`)}};Te=Ae([Le("_api/web")],Te);const Ue=K(Te);xe.prototype.batched=function(e){const t=Ce(this),[n,a]=Ne(t._root,e);return t.using(n),[t,a]},Te.prototype.batched=function(e){const t=Ue(this),[n,a]=Ne(t,e);return t.using(n),[t,a]};const Fe=Symbol.for("batch_registration"),He=Symbol.for("batch_request");class Re extends W{constructor(e,t=e.toUrl().replace(/_api[\\|/].*$/i,"")){super(t,"_api/$batch"),this.requestBaseUrl=t,this.using(A(e,"replace"),B(async e=>function(e){const t=[],n="--batchresponse_",a=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let r,o,s="batch",c={};const d=[];for(let e=0;e<i.length;++e){let l=i[e];switch(s){case"batch":if(l.substring(0,16)===n)s="batchHeaders";else if(""!==l.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===l.trim()&&(s="status");break;case"status":{const t=a.exec(l);if(3!==t.length)throw Error(`Invalid status, line ${e}`);r=parseInt(t[1],10),o=t[2],s="statusHeaders";break}case"statusHeaders":if(""===l.trim())s="body";else{const e=l.split(":");2===(null==e?void 0:e.length)&&(c[e[0].trim()]=e[1].trim())}break;case"body":for(d.length=0;l.substring(0,16)!==n;)d.push(l),l=i[++e];e--,t.push(new Response(204===r?null:d.join(""),{status:r,statusText:o,headers:c})),s="batch",c={}}}if("status"!==s)throw Error("Unexpected end of input");return t}(await e.text()))),this.on.dispose(()=>{e.using(A(this,"replace",e=>/(auth|send|pre|init)/i.test(e)))})}}function Ne(e,t){const n=[],a=[],i=[],o=new Re(e),s=c(),l=new Re(e),{headersCopyPattern:f,maxRequests:p}={headersCopyPattern:/Accept|Content-Type|IF-Match/i,maxRequests:20,...t};return[e=>(e.on.init(function(){if(d(this[Fe]))throw Error("This instance is already part of a batch. Please review the docs at https://pnp.github.io/pnpjs/concepts/batching#reuse.");return n.push(new Promise(e=>{this[Fe]=e})),this}),e.on.pre(async function(e,t,n){return _(t.headers,"X-PnP-BatchNever")?("function"==typeof this[He]&&(this[He](),delete this[He]),this.using(A(l,"replace",e=>/(init|pre)/i.test(e))),[e,t,n]):(this.on.auth.clear(),this.on.send.replace(async function(e,t){const n=new Promise(n=>{i.push([this,e.toString(),t,n])});return this.log(`[batch:${s}] (${(new Date).getTime()}) Adding request ${t.method} ${e.toString()} to batch.`,0),a.push(new Promise(e=>{this[He]=e})),this[Fe](),n}),this.on.dispose(function(){d(this[Fe])&&(this[Fe](),delete this[Fe]),d(this[He])&&(this[He](),delete this[He],this.using(A(l,"replace",e=>/(auth|pre|send|init|dispose)/i.test(e))))}),[e,t,n])}),e),async()=>{if(await Promise.all(n),i.length<1)return Promise.all(a).then(()=>{});const e=i.slice();for(;e.length>0;){const t=e.splice(0,p),n=[];let a="";for(let e=0;e<t.length;e++){const[,i,d]=t[e];"GET"===d.method?(a.length>0&&(n.push(`--changeset_${a}--\n\n`),a=""),n.push(`--batch_${s}\n`)):(a.length<1&&(a=c(),n.push(`--batch_${s}\n`),n.push(`Content-Type: multipart/mixed; boundary="changeset_${a}"\n\n`)),n.push(`--changeset_${a}\n`)),n.push("Content-Type: application/http\n"),n.push("Content-Transfer-Encoding: binary\n\n");const l=new Headers(d.headers),p=u(i)?i:r(o.requestBaseUrl,i);if("GET"!==d.method){let e=d.method;l.has("X-HTTP-Method")&&(e=l.get("X-HTTP-Method"),l.delete("X-HTTP-Method")),n.push(`${e} ${p} HTTP/1.1\n`)}else n.push(`${d.method} ${p} HTTP/1.1\n`);l.has("Accept")||l.append("Accept","application/json"),l.has("Content-Type")||l.append("Content-Type","application/json;charset=utf-8"),l.forEach((e,t)=>{f.test(t)&&n.push(`${t}: ${e}\n`)}),n.push("\n"),d.body&&n.push(`${d.body}\n\n`)}a.length>0&&(n.push(`--changeset_${a}--\n\n`),a=""),n.push(`--batch_${s}--\n`);const i=await ee(o,{body:n.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${s}`}});if(i.length!==t.length)throw Error("Could not properly parse responses to match requests in batch.");for(let e=0;e<i.length;e++)t[e][3](i[e])}await Promise.all(a).then(()=>{})}]}function Be(e){const t=new Date;return!p(e)||t>e.expiration?null:e}const je=new Map;class Ve extends Error{constructor(e){super(`SPFx Context supplied to ${e} Behavior is null or undefined.`)}static check(e,t){if(null==t)throw new Ve(e)}}function ze(e){return{DecodedUrl:e}}Reflect.defineProperty(xe.prototype,"web",{configurable:!0,enumerable:!0,get:function(){return this.create(Ue)}});let Ge=class extends Q{getById(e){return qe(this).concat(`('${e}')`)}getByTitle(e){return qe(this,`getByTitle('${Ee(e)}')`)}async add(e,t="",n=100,a=!1,i={}){const r={AllowContentTypes:a,BaseTemplate:n,ContentTypesEnabled:a,Description:t,Title:e,...i};return ee(this,z(r))}async ensure(e,t="",n=100,a=!1,i={}){const r={Title:e,Description:t,ContentTypesEnabled:a,...i},o=this.getByTitle(r.Title);try{return await o.select("Title")(),{created:!1,data:await o.update(r),list:this.getByTitle(r.Title)}}catch(i){return{created:!0,data:await this.add(e,t,n,a,r),list:this.getByTitle(r.Title)}}}async ensureSiteAssetsLibrary(){const e=await ee(Ke(this,"ensuresiteassetslibrary"));return qe([this,we(e)])}async ensureSitePagesLibrary(){const e=await ee(Ke(this,"ensuresitepageslibrary"));return qe([this,we(e)])}};Ge=Ae([Le("lists")],Ge);const Ke=K(Ge);class We extends J{constructor(){super(...arguments),this.delete=$()}get effectiveBasePermissions(){return q(this,"EffectiveBasePermissions")}get eventReceivers(){return Y(this,"EventReceivers")}get relatedFields(){return q(this,"getRelatedFields")}get informationRightsManagementSettings(){return q(this,"InformationRightsManagementSettings")}async update(e,t="*"){return await te(this,z(e,G({"IF-Match":t})))}getChanges(e){return ee(qe(this,"getchanges"),z({query:e}))}getItemsByCAMLQuery(e,...t){return ee(qe(this,"getitems").expand(...t),z({query:e}))}getListItemChangesSinceToken(e){return ee(qe(this,"getlistitemchangessincetoken").using(B(e=>e.text())),z({query:e}))}async recycle(){return ee(qe(this,"recycle"))}async renderListData(e){const t=qe(this,"renderlistdata(@viewXml)");t.query.set("@viewXml",`'${e}'`);const n=await ee(t);return JSON.parse(n)}renderListDataAsStream(e,t=null,n=new Map){_(e,"RenderOptions")&&l(e.RenderOptions)&&(e.RenderOptions=e.RenderOptions.reduce((e,t)=>e+t));const a=qe(this,"RenderListDataAsStream");n&&n.size>0&&n.forEach((e,t)=>a.query.set(t,e));const i=p(t)?{parameters:e,overrideParameters:t}:{parameters:e};return ee(a,z(i))}async renderListFormData(e,t,n){const a=await ee(qe(this,`renderlistformdata(itemid=${e}, formid='${t}', mode='${n}')`));return JSON.parse(a)}async reserveListItemId(){return ee(qe(this,"reservelistitemid"))}async addValidateUpdateItemUsingPath(e,t,n=!1,a,i){const r={FolderPath:ze(t)};return p(i)&&(i.leafName&&(r.LeafName=ze(i.leafName)),i.objectType&&(r.UnderlyingObjectType=i.objectType)),ee(qe(this,"AddValidateUpdateItemUsingPath()"),z({bNewDocumentUpdate:n,checkInComment:a,formValues:e,listItemCreateInfo:r}))}async getParentInfos(){const e=await this.select("Id","RootFolder/UniqueId","RootFolder/ServerRelativeUrl","RootFolder/ServerRelativePath","ParentWeb/Id","ParentWeb/Url","ParentWeb/ServerRelativeUrl","ParentWeb/ServerRelativePath").expand("RootFolder","ParentWeb")();return{List:{Id:e.Id,RootFolderServerRelativePath:e.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.RootFolder.UniqueId},ParentWeb:{Id:e.ParentWeb.Id,ServerRelativePath:e.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentWeb.ServerRelativeUrl,Url:e.ParentWeb.Url}}}}const qe=K(We);var Qe,Ye;!function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest",e[e.ListAvailableContentTypes=65536]="ListAvailableContentTypes",e[e.FolderContentTypeOrder=131072]="FolderContentTypeOrder",e[e.GridInitInfo=262144]="GridInitInfo",e[e.SiteUrlAsMediaTASPItemHost=524288]="SiteUrlAsMediaTASPItemHost",e[e.AddToOneDrive=1048576]="AddToOneDrive",e[e.SPFXCustomActions=2097152]="SPFXCustomActions",e[e.CustomActions=4194304]="CustomActions"}(Qe||(Qe={})),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(Ye||(Ye={})),V(Te,"lists",Ke),V(Te,"siteUserInfoList",qe),V(Te,"defaultDocumentLibrary",qe),V(Te,"customListTemplates",Y,"getcustomlisttemplates"),Te.prototype.getList=function(e){return qe(this,`getList('${Ee(e)}')`)},Te.prototype.getCatalog=async function(e){const t=await Ue(this,`getcatalog(${e})`).select("Id")();return qe([this,we(t)])};let Je=class extends Q{async createFieldAsXml(e){return"string"==typeof e&&(e={SchemaXml:e}),ee(Xe(this,"createfieldasxml"),z({parameters:e}))}getById(e){return Ze(this).concat(`('${e}')`)}getByTitle(e){return Ze(this,`getByTitle('${e}')`)}getByInternalNameOrTitle(e){return Ze(this,`getByInternalNameOrTitle('${e}')`)}async add(e,t,n){return ee(Xe(this,null),z(Object.assign({__metadata:{type:null!==(a=et[t])&&void 0!==a?a:"SP.Field"}},{Title:e,FieldTypeKind:t,...n}),G({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose"})));var a}async addField(e,t,n){return ee(Xe(this,"AddField"),z({parameters:{Title:e,FieldTypeKind:t,...n}}))}addText(e,t){return this.add(e,2,{MaxLength:255,...t})}addCalculated(e,t){return this.add(e,17,{OutputType:$e.Text,...t})}addDateTime(e,t){return this.add(e,4,{DateTimeCalendarType:it.Gregorian,DisplayFormat:tt.DateOnly,FriendlyDisplayFormat:nt.Unspecified,...t})}addNumber(e,t){return this.add(e,9,t)}addCurrency(e,t){return this.add(e,10,{CurrencyLocaleId:1033,...t})}addMultilineText(e,t){return this.add(e,3,{AllowHyperlink:!0,AppendOnly:!1,NumberOfLines:6,RestrictedMode:!1,RichText:!0,...t})}addUrl(e,t){return this.add(e,11,{DisplayFormat:rt.Hyperlink,...t})}addUser(e,t){return this.add(e,20,{SelectionMode:ot.PeopleAndGroups,...t})}async addLookup(e,t){return this.addField(e,7,t)}addChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,6,n)}addMultiChoice(e,t){const n={...t,Choices:{results:t.Choices}};return this.add(e,15,n)}addBoolean(e,t){return this.add(e,8,t)}async addDependentLookupField(e,t,n){return ee(Xe(this,`adddependentlookupfield(displayName='${e}', primarylookupfieldid='${t}', showfield='${n}')`))}addLocation(e,t){return this.add(e,33,t)}addImageField(e,t){return this.add(e,34,t)}};Je=Ae([Le("fields")],Je);const Xe=K(Je),Ze=K(class extends J{constructor(){super(...arguments),this.delete=Z()}async update(e,t){return null==t&&(t=(await Ze(this).select("FieldTypeKind")())["odata.type"]),te(this,z(e))}setShowInDisplayForm(e){return ee(Ze(this,`setshowindisplayform(${e})`))}setShowInEditForm(e){return ee(Ze(this,`setshowineditform(${e})`))}setShowInNewForm(e){return ee(Ze(this,`setshowinnewform(${e})`))}});var $e;!function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType",e[e.Location=33]="Location",e[e.Image=34]="Image"}($e||($e={}));const et={[$e.Calculated]:"SP.FieldCalculated",[$e.Choice]:"SP.FieldChoice",[$e.Computed]:"SP.FieldComputed",[$e.Currency]:"SP.FieldCurrency",[$e.DateTime]:"SP.FieldDateTime",[$e.GridChoice]:"SP.FieldRatingScale",[$e.Guid]:"SP.FieldGuid",[$e.Image]:"SP.FieldMultiLineText",[$e.Integer]:"SP.FieldNumber",[$e.Location]:"SP.FieldLocation",[$e.Lookup]:"SP.FieldLookup",[$e.ModStat]:"SP.FieldChoice",[$e.MultiChoice]:"SP.FieldMultiChoice",[$e.Note]:"SP.FieldMultiLineText",[$e.Number]:"SP.FieldNumber",[$e.Text]:"SP.FieldText",[$e.URL]:"SP.FieldUrl",[$e.User]:"SP.FieldUser",[$e.WorkflowStatus]:"SP.FieldChoice",[$e.WorkflowEventType]:"SP.FieldNumber"};var tt,nt,at,it,rt,ot,st;!function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(tt||(tt={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.Disabled=1]="Disabled",e[e.Relative=2]="Relative"}(nt||(nt={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(at||(at={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(it||(it={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(rt||(rt={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(ot||(ot={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(st||(st={})),V(Te,"fields",Xe),V(Te,"availablefields",Xe),V(We,"fields",Xe),o(946);const ct="status_51f82e1a";let dt=class extends Q{getById(e){return ut(this).concat(`(${e})`)}getItemByStringId(e){return ut([this,this.parentUrl],`getItemByStringId('${e}')`)}skip(e,t=!1){return t?this.query.set("$skiptoken",`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`):this.query.set("$skiptoken",`Paged=TRUE&p_ID=${e}`),this}[Symbol.asyncIterator](){const e=Y(this).using(B(async e=>{const t=await e.json(),n=_(t,"d")&&_(t.d,"__next")?t.d.__next:t["odata.nextLink"];return{hasNext:"string"==typeof n&&n.length>0,nextLink:n,value:N(t)}})),t=["$top","$select","$expand","$filter","$orderby","$skiptoken"];for(let n=0;n<t.length;n++){const a=this.query.get(t[n]);p(a)&&e.query.set(t[n],a)}return{_next:e,async next(){if(null===this._next)return{done:!0,value:void 0};const e=await this._next();return e.hasNext?(this._next=Y([this._next,e.nextLink]),{done:!1,value:e.value}):(this._next=null,{done:!1,value:e.value})}}}async add(e={}){return ee(this,z(e))}};dt=Ae([Le("items")],dt);const lt=K(dt),ut=K(class extends J{constructor(){super(...arguments),this.delete=$()}get effectiveBasePermissions(){return q(this,"EffectiveBasePermissions")}get effectiveBasePermissionsForUI(){return q(this,"EffectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return X(this,"FieldValuesAsHTML")}get fieldValuesAsText(){return X(this,"FieldValuesAsText")}get fieldValuesForEdit(){return X(this,"FieldValuesForEdit")}get versions(){return pt(this)}get list(){return this.getParent(qe,"",this.parentUrl.substring(0,this.parentUrl.lastIndexOf("/")))}async update(e,t="*"){const n=z(e,G({"IF-Match":t,"X-HTTP-Method":"MERGE"}));return ee(ut(this).using(B(async e=>({etag:e.headers.get("etag")}))),n)}recycle(){return ee(ut(this,"recycle"))}async deleteWithParams(e){return ee(ut(this,"DeleteWithParameters"),z({parameters:e}))}async getWopiFrameUrl(e=0){const t=ut(this,"getWOPIFrameUrl(@action)");return t.query.set("@action",e),ee(t)}validateUpdateListItem(e,t=!1){return ee(ut(this,"validateupdatelistitem"),z({formValues:e,bNewDocumentUpdate:t}))}async getParentInfos(){const e=await this.select("Id","ParentList/Id","ParentList/Title","ParentList/RootFolder/UniqueId","ParentList/RootFolder/ServerRelativeUrl","ParentList/RootFolder/ServerRelativePath","ParentList/ParentWeb/Id","ParentList/ParentWeb/Url","ParentList/ParentWeb/ServerRelativeUrl","ParentList/ParentWeb/ServerRelativePath").expand("ParentList","ParentList/RootFolder","ParentList/ParentWeb")();return{Item:{Id:e.Id},ParentList:{Id:e.ParentList.Id,Title:e.ParentList.Title,RootFolderServerRelativePath:e.ParentList.RootFolder.ServerRelativePath,RootFolderServerRelativeUrl:e.ParentList.RootFolder.ServerRelativeUrl,RootFolderUniqueId:e.ParentList.RootFolder.UniqueId},ParentWeb:{Id:e.ParentList.ParentWeb.Id,ServerRelativePath:e.ParentList.ParentWeb.ServerRelativePath,ServerRelativeUrl:e.ParentList.ParentWeb.ServerRelativeUrl,Url:e.ParentList.ParentWeb.Url}}}async setImageField(e,t,n){const a=await this.getParentInfos(),i=Oe(this.toUrl()),r=q([this,i],"/_api/web/UploadImage");r.concat("(listTitle=@a1,imageName=@a2,listId=@a3,itemId=@a4)"),r.query.set("@a1",`'${a.ParentList.Title}'`),r.query.set("@a2",`'${t}'`),r.query.set("@a3",`'${a.ParentList.Id}'`),r.query.set("@a4",a.Item.Id);const o=await ee(r,{body:n}),s={type:"thumbnail",fileName:o.Name,nativeFile:{},fieldName:e,serverUrl:a.ParentWeb.Url.replace(a.ParentWeb.ServerRelativeUrl,""),serverRelativeUrl:o.ServerRelativeUrl,id:o.UniqueId};return this.validateUpdateListItem([{FieldName:e,FieldValue:JSON.stringify(s)}])}});let ft=class extends Q{getById(e){return mt(this).concat(`(${e})`)}};ft=Ae([Le("versions")],ft);const pt=K(ft),mt=K(class extends J{constructor(){super(...arguments),this.delete=$()}});function _t(t){var n=this,a=t.sp,i=t.title,r=t.listId,o=t.groupField,s=t.viewUrl,c=t.maxPer,d=t.showCounts,l=t.twoLineClamp,u=e.useState(!0),f=u[0],p=u[1],m=e.useState({}),_=m[0],h=m[1],b=e.useState(null),g=b[0],v=b[1];e.useEffect(function(){var e,t,i;e=n,i=function(){var e,t,n;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(i){switch(i.label){case 0:if(!r)return h({}),p(!1),[2];v(null),p(!0),i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,a.web.lists.getById(r).items.select("Id,Title,FileRef,FSObjType,".concat(o)).filter("FSObjType eq 0")()];case 2:return e=i.sent(),t={},e.forEach(function(e){var n=e[o]||"Uncategorized";(t[n]||(t[n]=[])).push({Id:e.Id,Title:e.Title,FileRef:e.FileRef})}),h(t),[3,5];case 3:return n=i.sent(),console.error("DocTiles load error",n),v((null==n?void 0:n.message)||String(n)),h({}),[3,5];case 4:return p(!1),[7];case 5:return[2]}})},new((t=void 0)||(t=Promise))(function(n,a){function r(e){try{s(i.next(e))}catch(e){a(e)}}function o(e){try{s(i.throw(e))}catch(e){a(e)}}function s(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t(function(e){e(a)})).then(r,o)}s((i=i.apply(e,[])).next())})},[a,r,o]);var y=e.useMemo(function(){return Object.keys(_).sort(function(e,t){return e.localeCompare(t)})},[_]),S=function(e){return s?"".concat(s,"?FilterField1=").concat(encodeURIComponent(o),"&FilterValue1=").concat(encodeURIComponent(e)):"#"};return e.createElement("div",{className:"host_51f82e1a"},e.createElement("div",{className:"header_51f82e1a"},e.createElement("h2",null,i),s&&e.createElement("a",{href:s,target:"_blank",rel:"noopener"},"View all")),g&&e.createElement("div",{className:ct,style:{color:"#d83b01"}},"Failed to load: ",g),f&&!g&&e.createElement("div",{className:ct},"Loading…"),!f&&!g&&e.createElement("div",{className:"grid_51f82e1a"},y.map(function(t){var n=_[t]||[];return e.createElement("div",{key:t,className:"card_51f82e1a"},e.createElement("div",{className:"catbar_51f82e1a"},e.createElement("div",{className:"catname_51f82e1a"},t),d&&e.createElement("div",{className:"count_51f82e1a"},n.length)),e.createElement("div",{className:"doclist_51f82e1a"},n.slice(0,c).map(function(t){return e.createElement("a",{key:t.Id,className:"".concat("pill_51f82e1a"," ").concat(l?"clamp2_51f82e1a":""),href:t.FileRef,target:"_blank",rel:"noopener","aria-label":"".concat(t.Title||t.FileRef," (opens in new tab)")},e.createElement("span",{className:"dot_51f82e1a"}),e.createElement("span",{className:"title_51f82e1a"},t.Title||(t.FileRef||"").split("/").pop()))})),n.length>c&&s&&e.createElement("div",{className:"foot_51f82e1a"},e.createElement("a",{className:"more_51f82e1a",href:S(t),target:"_blank",rel:"noopener"},"More…")))}),0===y.length&&e.createElement("div",{className:ct},"No documents found.")))}V(We,"items",lt);var ht,bt=(ht=function(e,t){return ht=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},ht(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}ht(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),gt=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},vt=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}};const yt=function(n){function o(){var e=null!==n&&n.apply(this,arguments)||this;return e._listOptions=[],e._fieldOptions=[],e._loadingLists=!1,e._loadingFields=!1,e}return bt(o,n),o.prototype.onInit=function(){return gt(this,void 0,void 0,function(){return vt(this,function(e){switch(e.label){case 0:return[4,n.prototype.onInit.call(this)];case 1:return e.sent(),this._sp=Ce().using((t=this.context,Ve.check("SPFx",t),e=>{return e.using(e=>(e.using(function(e,t=!1){return n=>{const a=async function(t,n,a){return n.headers={...n.headers,...e},[t,n,a]};return t?n.on.pre.prepend(a):n.on.pre(a),n}}({Accept:"application/json","Content-Type":"application/json;charset=utf-8"})),e),e=>(e.on.pre(async(e,t,n)=>(t.cache="no-cache",t.credentials="same-origin",[e,t,n])),e.using(e=>(e.on.pre(async function(e,t,n){let a="PnPCoreJS:4.16.0:";const{pathname:i}=new URL(e);return a=i.split("/").filter(e=>!f(e)&&["_api","v2.1","v2.0"].indexOf(e)<0).map((e,t,n)=>t===n.length-1?e.replace(/\(.*?$/i,"()"):e[0]).join("."),a.length>32&&(a=a.substring(0,32)),this.log(`Request Tag: ${a}`,0),t.headers={...t.headers,"X-ClientService-ClientTag":a},[e,t,n]}),e),e=>(e.on.error(function(e){this.emit[this.InternalReject](e)}),e),e=>(e.on.data(function(e){this.emit[this.InternalResolve](e)}),e)),e),function(){const{interval:e,replace:t,retries:n}={replace:!0,interval:200,retries:3};return a=>(t&&a.on.send.clear(),a.on.send(function(t,a){let i,r,o=e,s=0;const c=async()=>{if(s>=n)throw r||new j(`Retry count exceeded (${n}) for this request. ${i.status}: ${i.statusText};`,i);if(s++,void 0!==i&&429!==(null==i?void 0:i.status)&&503!==(null==i?void 0:i.status)&&504!==(null==i?void 0:i.status))return i;void 0!==i&&(i.headers.has("Retry-After")?o=1e3*parseInt(i.headers.get("Retry-After"),10):o*=2,this.log(`Attempt #${s} to retry request which failed with ${i.status}: ${i.statusText}`,0),await(e=o,new Promise(t=>{setTimeout(t,e)})));try{const e=t.toString();return this.log(`Fetch: ${a.method} ${e}`,0),i=await fetch(e,a),i.ok?i:c()}catch(e){if(/AbortError/.test(e.name))throw e;return r=e,c()}var e};return c()}),a)}(),B(async e=>{if(e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status)return{};const t=await e.text();return N(t.replace(/\s/gi,"").length>0?JSON.parse(t):{})}),(n=e=>{var n,a,o;if(new RegExp(`^${r(t.pageContext.web.absoluteUrl,"/_api")}`,"i").test(e)&&(null===(a=null===(n=null==t?void 0:t.pageContext)||void 0===n?void 0:n.legacyPageContext)||void 0===a?void 0:a.formDigestValue)){const e=new Date(t.pageContext.legacyPageContext.formDigestValue.split(",")[1]);return{value:t.pageContext.legacyPageContext.formDigestValue,expiration:i(e,"second",(null===(o=t.pageContext.legacyPageContext)||void 0===o?void 0:o.formDigestTimeoutSeconds)-15||1585)}}},e=>(e.on.pre(async function(e,t,a){return this.on.auth(async(e,t)=>{if(/get/i.test(t.method)||t.headers&&(_(t.headers,"X-RequestDigest")||_(t.headers,"Authorization")||_(t.headers,"X-PnPjs-NoDigest")))return[e,t];const a=e.toString(),o=Oe(a);let s=Be(je.get(o));return!p(s)&&d(n)&&(s=Be(n(a))),p(s)||(s=await ee(q([this,r(o,"_api/contextinfo")]).using(B(e=>e.json()),e=>(e.on.pre.prepend(async function(e,t,n){return t.headers={...t.headers,"X-PnP-BatchNever":"1"},[e,t,n]}),e)),{headers:{Accept:"application/json","X-PnPjs-NoDigest":"1"}}).then(e=>({expiration:i(new Date,"second",e.FormDigestTimeoutSeconds),value:e.FormDigestValue}))),p(s)&&(t.headers={"X-RequestDigest":s.value,...t.headers},je.set(o,s)),[e,t]}),[e,t,a]}),e))),e.on.pre.prepend(async(e,n,a)=>(u(e)||(e=r(t.pageContext.web.absoluteUrl,e)),[e,n,a])),e;var n})),[4,this._loadLists()];case 2:return e.sent(),this.properties.listId?[4,this._loadFields(this.properties.listId)]:[3,4];case 3:e.sent(),e.label=4;case 4:return void 0===this.properties.maxPerCategory&&(this.properties.maxPerCategory=6),void 0===this.properties.title&&(this.properties.title="Document Hub"),void 0===this.properties.showCounts&&(this.properties.showCounts=!0),void 0===this.properties.twoLineClamp&&(this.properties.twoLineClamp=!0),[2]}var t})})},o.prototype._loadLists=function(){return gt(this,void 0,void 0,function(){var e,t,n;return vt(this,function(a){switch(a.label){case 0:if(this._loadingLists)return[2];this._loadingLists=!0,a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this._sp.web.lists.select("Id,Title,BaseTemplate,Hidden")()];case 2:return e=a.sent(),t=e.filter(function(e){return!e.Hidden&&(101===e.BaseTemplate||100===e.BaseTemplate)}),this._listOptions=t.map(function(e){return{key:e.Id,text:e.Title}}),[3,5];case 3:return n=a.sent(),console.error("List load error",n),this._listOptions=[],[3,5];case 4:return this._loadingLists=!1,[7];case 5:return[2]}})})},o.prototype._loadFields=function(e){return gt(this,void 0,void 0,function(){var t,n,a;return vt(this,function(i){switch(i.label){case 0:if(this._loadingFields)return[2];this._loadingFields=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,this._sp.web.lists.getById(e).fields.select("InternalName,Title,Hidden,ReadOnlyField,TypeAsString")()];case 2:return t=i.sent(),n=new Set(["Text","Choice","Lookup","TaxonomyFieldType","TaxonomyFieldTypeMulti"]),this._fieldOptions=t.filter(function(e){return!e.Hidden&&!e.ReadOnlyField&&n.has(e.TypeAsString)}).map(function(e){return{key:e.InternalName,text:"".concat(e.Title," (").concat(e.InternalName,")")}}),[3,5];case 3:return a=i.sent(),console.error("Field load error",a),this._fieldOptions=[],[3,5];case 4:return this._loadingFields=!1,[7];case 5:return[2]}})})},o.prototype.onPropertyPaneConfigurationStart=function(){return gt(this,void 0,void 0,function(){return vt(this,function(e){switch(e.label){case 0:return[4,this._loadLists()];case 1:return e.sent(),this.properties.listId?[4,this._loadFields(this.properties.listId)]:[3,3];case 2:e.sent(),e.label=3;case 3:return this.context.propertyPane.refresh(),[2]}})})},o.prototype.onPropertyPaneFieldChanged=function(e,t,a){return gt(this,void 0,void 0,function(){return vt(this,function(i){switch(i.label){case 0:return"listId"===e&&a&&a!==t?[4,this._loadFields(a)]:[3,2];case 1:i.sent(),this.properties.groupFieldInternalName=void 0,this.context.propertyPane.refresh(),i.label=2;case 2:return n.prototype.onPropertyPaneFieldChanged.call(this,e,t,a),this.render(),[2]}})})},o.prototype.render=function(){var n=e.createElement(_t,{sp:this._sp,title:this.properties.title||"Document Hub",listId:this.properties.listId,groupField:this.properties.groupFieldInternalName||"Category",viewUrl:this.properties.viewUrl,maxPer:this.properties.maxPerCategory||6,showCounts:!!this.properties.showCounts,twoLineClamp:!!this.properties.twoLineClamp});t.render(n,this.domElement)},o.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:"Doc Tiles — Generic grouped document view"},groups:[{groupName:"Basics",groupFields:[(0,a.PropertyPaneTextField)("title",{label:"Title",placeholder:"Document Hub"}),(0,a.PropertyPaneDropdown)("listId",{label:"List/Library",options:this._listOptions,selectedKey:this.properties.listId,disabled:0===this._listOptions.length}),(0,a.PropertyPaneDropdown)("groupFieldInternalName",{label:"Group by column",options:this._fieldOptions,selectedKey:this.properties.groupFieldInternalName,disabled:!this.properties.listId||0===this._fieldOptions.length}),(0,a.PropertyPaneTextField)("viewUrl",{label:'View URL (for "View all" & "More…")',placeholder:"/sites/Dept/Library/Forms/AllItems.aspx"}),(0,a.PropertyPaneTextField)("maxPerCategory",{label:"Max items per category",value:String(this.properties.maxPerCategory||6)}),(0,a.PropertyPaneToggle)("showCounts",{label:"Show counts in header",checked:this.properties.showCounts}),(0,a.PropertyPaneToggle)("twoLineClamp",{label:"Clamp file title to two lines",checked:this.properties.twoLineClamp})]}]}]}},o.prototype.onDispose=function(){t.unmountComponentAtNode(this.domElement)},o}(n.BaseClientSideWebPart)})(),s})());